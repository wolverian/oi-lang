version: 2
jobs:
    build:
        working_directory: /root/oi-lang
        docker:
            - image: clojure
        steps:
            - run: cd /tmp && wget -q https://bitbucket.org/ariya/phantomjs/downloads/phantomjs-2.1.1-linux-x86_64.tar.bz2 && tar jxf phantomjs-2.1.1-linux-x86_64.tar.bz2
            - checkout
            - run: npm install -g karma-cli
            - run: lein deps
            - run: env PATH=/tmp/phantomjs-2.1.1-linux-x86_64/bin:$PATH lein karma-once
            - store_test_results:
                path: run/compiled/karma/test/junit/karma

